---
title: "Saving MOL Files of Chemicals"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Saving_MOL_Files_of_Chemicals}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

MOL files are returned by multiple possible API queries. Most obivously by `get_recordId_mol()`, but also as part of `get_recordId_details()`. Saving those human-readable MOL files from R is possible with `base` R functionality.

### Downloading the MOL file of caffeine

For demonstration purposes, we will work with the MOL file for caffeine. Before starting, we need to load the `chemspiderapi` package and retrieve the API key. See the seperate vignette "Storing and Accessing API Keys" for details on handling API keys using the `keyring` package.

```{r setup}
library(chemspiderapi)

apikey <- keyring::key_get(service = "ChemSpider API key", username = Sys.getenv("USERNAME"))
```

We can now get the MOL file for caffeine, which has a ChemSpider ID of 2424.

```{r,eval=FALSE}
caffein_mol <- get_recordId_mol(recordId = 2424, apikey = apikey)
```


### Saving the MOL file

Saving the file is done using the `writeLines()` function. 

```{r,eval=FALSE}
## Writing the MOL file. Note that the file is specified as a connection.
writeLines(caffein_mol, con = file("caffein.mol"))
```

